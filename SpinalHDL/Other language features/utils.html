

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Utils &mdash; SpinalHDL  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/default.js"></script>
        <script src="../../_static/wavedrom.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Assertions" href="assertion.html" />
    <link rel="prev" title="Other language features" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> SpinalHDL
          

          
          </a>

          
            
            
              <div class="version">
                v1.3.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../About SpinalHDL/index.html">About SpinalHDL</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../About SpinalHDL/faq.html">FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../About SpinalHDL/support.html">Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../About SpinalHDL/users.html">Users</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Getting Started/index.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Getting Started/getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Getting Started/motivation.html">Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Getting Started/presentation.html">Presentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Getting Started/Scala Guide/index.html">Scala Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Getting Started/Scala Guide/basics.html">Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Getting Started/Scala Guide/coding_conventions.html">Coding conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Getting Started/Scala Guide/interaction.html">Interaction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Getting Started/Help for VHDL people/index.html">Help for VHDL people</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Getting Started/Help for VHDL people/vhdl_comp.html">VHDL comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Getting Started/Help for VHDL people/vhdl_perspective.html">VHDL equivalences</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Getting Started/Cheatsheets/index.html">Cheatsheets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Getting Started/Cheatsheets/core.html">Core</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Getting Started/Cheatsheets/lib.html">Lib</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Getting Started/Cheatsheets/symbolic.html">Symbolic</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Data types/index.html">Data types</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Data types/bool.html">Bool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Data types/bits.html">Bits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Data types/Int.html">UInt/SInt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Data types/enum.html">SpinalEnum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Data types/bundle.html">Bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Data types/Vec.html">Vec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Data types/Fix.html">UFix/SFix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Data types/Floating.html">Floating</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Structuring/index.html">Structuring</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Structuring/components_hierarchy.html">Component and hierarchy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Structuring/area.html">Area</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Structuring/function.html">Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Structuring/clock_domain.html">Clock domains</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Structuring/blackbox.html">Instantiate VHDL and Verilog IP</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Semantic/index.html">Semantic</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Semantic/assignments.html">Assignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Semantic/when_switch.html">When/Switch/Mux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Semantic/rules.html">Rules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Sequential logic/index.html">Sequential logic</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Sequential logic/registers.html">Registers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Sequential logic/memory.html">RAM/ROM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Design errors/index.html">Design errors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Design errors/assignment_overlap.html">Assignment overlap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design errors/clock_crossing_violation.html">Clock crossing violation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design errors/combinatorial_loop.html">Combinatorial loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design errors/hierarchy_violation.html">Hierarchy violation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design errors/iobundle.html">Io bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design errors/latch_detected.html">Latch detected</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design errors/no_driver_on.html">No driver on</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design errors/nullpointerexception.html">NullPointerException</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design errors/register_defined_as_component_input.html">Register defined as component input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design errors/scope_violation.html">Scope violation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design errors/spinal_cant_clone.html">Spinal can’t clone class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design errors/unassigned_register.html">Unassigned register</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design errors/unreachable_is_statement.html">Unreachable is statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design errors/width_mismatch.html">Width mismatch</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Other language features</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="assertion.html">Assertions</a></li>
<li class="toctree-l2"><a class="reference internal" href="formal.html">Formal</a></li>
<li class="toctree-l2"><a class="reference internal" href="analog_inout.html">Analog and inout</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_generation.html">VHDL and Verilog generation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Libraries/index.html">Libraries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Libraries/utils.html">Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Libraries/stream.html">Stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Libraries/flow.html">Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Libraries/fragment.html">Fragment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Libraries/fsm.html">State machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Libraries/vexriscv.html">VexRiscv (RV32IM CPU)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Libraries/bus_slave_factory.html">Bus Slave Factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Libraries/generator.html">Generator framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Libraries/Bus/index.html">Bus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Libraries/Bus/amba3/ahblite3.html">AHB-Lite3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Libraries/Bus/amba3/apb3.html">Apb3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Libraries/Bus/amba4/axi4.html">Axi4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Libraries/Bus/avalon/avalonmm.html">AvalonMM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Libraries/Com/index.html">Com</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Libraries/Com/uart.html">UART</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Libraries/IO/index.html">IO</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Libraries/IO/readableOpenDrain.html">ReadableOpenDrain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Libraries/IO/tristate.html">TriState</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Libraries/Graphics/index.html">Graphics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Libraries/Graphics/colors.html">Colors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Libraries/Graphics/vga.html">VGA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Libraries/EDA/index.html">EDA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Libraries/EDA/altera/qsysify.html">QSysify</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Simulation/index.html">Simulation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Simulation/install.html">Setup and installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Simulation/bootstraps.html">Boot a simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Simulation/signal.html">Accessing signals of the simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Simulation/clock.html">Clock domains</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Simulation/threadFull.html">Thread-full API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Simulation/threadLess.html">Thread-less API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Simulation/engine.html">Simulation engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Simulation/examples/index.html">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Simulation/examples/asynchronous.html">Asynchronous adder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Simulation/examples/dual_clock_fifo.html">Dual clock fifo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Simulation/examples/single_clock_fifo.html">Single clock fifo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Simulation/examples/synchronous.html">Synchronous adder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Simulation/examples/uart_decoder.html">Uart decoder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Simulation/examples/uart_encoder.html">Uart encoder</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Examples/Simple ones/index.html">Simple ones</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Simple ones/apb3.html">APB3 definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Simple ones/carry_adder.html">Carry adder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Simple ones/color_summing.html">Color summing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Simple ones/counter_with_clear.html">Counter with clear</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Simple ones/introduction.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Simple ones/pll_resetctrl.html">PLL BlackBox and reset controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Simple ones/rgb_to_gray.html">RGB to gray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Simple ones/sinus_rom.html">Sinus rom</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/Intermediates ones/index.html">Intermediates ones</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Intermediates ones/fractal.html">Fractal calculator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Intermediates ones/uart.html">UART</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Intermediates ones/vga.html">VGA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/Advanced ones/index.html">Advanced ones</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Advanced ones/jtag.html">JTAG TAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Advanced ones/memory_mapped_uart.html">Memory mapped UART</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Advanced ones/pinesec.html">Pinesec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Advanced ones/timer.html">Timer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Legacy/index.html">Legacy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Legacy/riscv.html">RiscV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Legacy/pinsec/index.html">pinsec</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Legacy/pinsec/hardware.html">Hardware</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Legacy/pinsec/hardware_toplevel.html">SoC toplevel (Pinsec)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Legacy/pinsec/introduction.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Legacy/pinsec/software.html">Software</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Developers area/index.html">Developers area</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Developers area/bus_slave_factory_impl.html">Bus Slave Factory Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Developers area/howtodocument.html">How to HACK this documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Developers area/types.html">Types</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SpinalHDL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Other language features</a> &raquo;</li>
        
      <li>Utils</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/SpinalHDL/Other language features/utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="utils">
<span id="id1"></span><h1>Utils<a class="headerlink" href="#utils" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general">
<h2>General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h2>
<p>Many tools and utilities are present in <a class="reference internal" href="../Libraries/index.html#lib-introduction"><span class="std std-ref">spinal.lib</span></a> but some are already present in SpinalHDL Core.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 38%" />
<col style="width: 13%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Syntax</p></th>
<th class="head"><p>Return</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>widthOf(x : BitVector)</p></td>
<td><p>Int</p></td>
<td><p>Return the width of a Bits/UInt/SInt signal</p></td>
</tr>
<tr class="row-odd"><td><p>log2Up(x : BigInt)</p></td>
<td><p>Int</p></td>
<td><p>Return the number of bits needed to represent x states</p></td>
</tr>
<tr class="row-even"><td><p>isPow2(x : BigInt)</p></td>
<td><p>Boolean</p></td>
<td><p>Return true if x is a power of two</p></td>
</tr>
<tr class="row-odd"><td><p>roundUp(that : BigInt, by : BigInt)</p></td>
<td><p>BigInt</p></td>
<td><p>Return the first <code class="docutils literal notranslate"><span class="pre">by</span></code> multiply from <code class="docutils literal notranslate"><span class="pre">that</span></code> (included)</p></td>
</tr>
<tr class="row-even"><td><p>Cat(x : Data*)</p></td>
<td><p>Bits</p></td>
<td><p>Concatenate all arguments, the first in MSB, the last in LSB</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cloning-hardware-datatypes">
<h2>Cloning hardware datatypes<a class="headerlink" href="#cloning-hardware-datatypes" title="Permalink to this headline">¶</a></h2>
<p>You can clone a given hardware data type by using the <code class="docutils literal notranslate"><span class="pre">cloneOf(x)</span></code> function. It will return a new instance of the same Scala type and parameters.</p>
<p>For example :</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="n">plusOne</span><span class="o">(</span><span class="n">value</span> <span class="k">:</span> <span class="kt">UInt</span><span class="o">)</span> <span class="k">:</span> <span class="kt">UInt</span> <span class="o">=</span> <span class="o">{</span>
  <span class="c1">//Will recreate a UInt with the same width than ``value``</span>
  <span class="k">val</span> <span class="n">temp</span> <span class="k">=</span> <span class="n">cloneOf</span><span class="o">(</span><span class="n">value</span><span class="o">)</span>
  <span class="n">temp</span> <span class="o">:=</span> <span class="n">value</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="k">return</span> <span class="n">temp</span>
<span class="o">}</span>

<span class="c1">//treePlusOne will become a 8 bits value</span>
<span class="k">val</span> <span class="n">treePlusOne</span> <span class="k">=</span> <span class="n">plusOne</span><span class="o">(</span><span class="n">U</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">8</span> <span class="n">bits</span><span class="o">))</span>
</pre></div>
</div>
<p>You can get more information about how hardware data types are managed <a class="reference internal" href="../Getting Started/Scala Guide/interaction.html#hardware-type"><span class="std std-ref">here</span></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use the cloneOf function on a Bundle, this Bundle should be a case class or should override the clone function internally.</p>
</div>
</div>
<div class="section" id="passing-a-datatype-as-construction-parameter">
<h2>Passing a datatype as construction parameter<a class="headerlink" href="#passing-a-datatype-as-construction-parameter" title="Permalink to this headline">¶</a></h2>
<p>Many pieces of reusable hardware need to be parameterized by some data type. For example if you want to define a FIFO or a shift register, you need a parameter to specify which kind of payload you want for the component.</p>
<p>There are two similar ways to do this.</p>
<div class="section" id="the-old-way">
<h3>The old way<a class="headerlink" href="#the-old-way" title="Permalink to this headline">¶</a></h3>
<p>A good example of the old way to do that is in this definition of a ShiftRegister:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="k">class</span> <span class="nc">ShiftRegister</span><span class="o">[</span><span class="kt">T</span> <span class="k">&lt;:</span> <span class="kt">Data</span><span class="o">](</span><span class="n">dataType</span><span class="k">:</span> <span class="kt">T</span><span class="o">,</span> <span class="n">depth</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Component</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">io</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Bundle</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">input</span>  <span class="k">=</span> <span class="n">in</span> <span class="o">(</span><span class="n">cloneOf</span><span class="o">(</span><span class="n">dataType</span><span class="o">))</span>
    <span class="k">val</span> <span class="n">output</span> <span class="k">=</span> <span class="n">out</span><span class="o">(</span><span class="n">cloneOf</span><span class="o">(</span><span class="n">dataType</span><span class="o">))</span>
  <span class="o">}</span>
  <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<p>And here is how you can instantiate the component:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">shiftReg</span> <span class="k">=</span> <span class="nc">ShiftRegister</span><span class="o">(</span><span class="nc">Bits</span><span class="o">(</span><span class="mi">32</span> <span class="n">bits</span><span class="o">),</span><span class="n">depth</span> <span class="k">=</span> <span class="mi">8</span><span class="o">)</span>
</pre></div>
</div>
<p>As you can see, the raw hardware type is directly passed as a construction parameter. Then each time you want to create an new instance of that kind of hardware data type, you need to use the cloneOf(…) function. Doing things this way is not super safe as it’s easy to forget to use cloneOf().</p>
</div>
<div class="section" id="the-safe-way">
<h3>The safe way<a class="headerlink" href="#the-safe-way" title="Permalink to this headline">¶</a></h3>
<p>An example of the safe way to pass a data type parameter is as follows:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="k">class</span> <span class="nc">ShiftRegister</span><span class="o">[</span><span class="kt">T</span> <span class="k">&lt;:</span> <span class="kt">Data</span><span class="o">](</span><span class="n">dataType</span><span class="k">:</span> <span class="kt">HardType</span><span class="o">[</span><span class="kt">T</span><span class="o">],</span> <span class="n">depth</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Component</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">io</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Bundle</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">input</span>  <span class="k">=</span> <span class="n">in</span> <span class="o">(</span><span class="n">dataType</span><span class="o">())</span>
    <span class="k">val</span> <span class="n">output</span> <span class="k">=</span> <span class="n">out</span><span class="o">(</span><span class="n">dataType</span><span class="o">())</span>
  <span class="o">}</span>
  <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<p>And here is how you instantiate the component (exactly the same as before):</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">shiftReg</span> <span class="k">=</span> <span class="nc">ShiftRegister</span><span class="o">(</span><span class="nc">Bits</span><span class="o">(</span><span class="mi">32</span> <span class="n">bits</span><span class="o">),</span><span class="n">depth</span> <span class="k">=</span> <span class="mi">8</span><span class="o">)</span>
</pre></div>
</div>
<p>Notice how the example above uses a HardType wrapper around the raw data type <code class="docutils literal notranslate"><span class="pre">T</span></code>, which is kind of a blueprint definition of an hardware data type. This way of doing things is easier to use than the “old way”, because to create a new instance of the hardware data type you just need to call the <code class="docutils literal notranslate"><span class="pre">apply</span></code> function of that HardType (or in other words, just add parentheses after the parameter).</p>
<p>Additionally, this mechanism is completely transparent from the point of view of the user, as a hardware data type can be implicitly converted into an HardType.</p>
</div>
</div>
<div class="section" id="frequency-and-time">
<h2>Frequency and time<a class="headerlink" href="#frequency-and-time" title="Permalink to this headline">¶</a></h2>
<p>SpinalHDL HDL has a dedicated syntax to defne frequency and time values:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">frequency</span> <span class="k">=</span> <span class="mi">100</span> <span class="nc">MHz</span>
<span class="k">val</span> <span class="n">timeoutLimit</span> <span class="k">=</span> <span class="mi">3</span> <span class="n">ms</span>
<span class="k">val</span> <span class="n">period</span> <span class="k">=</span> <span class="mi">100</span> <span class="n">us</span>

<span class="k">val</span> <span class="n">periodCycles</span> <span class="k">=</span> <span class="n">frequency</span><span class="o">*</span><span class="n">period</span>
<span class="k">val</span> <span class="n">timeoutCycles</span> <span class="k">=</span> <span class="n">frequency</span><span class="o">*</span><span class="n">timeoutLimit</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">For time definitions you can use following postfixes to get a <code class="docutils literal notranslate"><span class="pre">TimeNumber</span></code> :</div>
<div class="line">fs, ps, ns, us, ms, sec, mn, hr</div>
</div>
<div class="line-block">
<div class="line">For time definitions you can use following postfixes to get a <code class="docutils literal notranslate"><span class="pre">HertzNumber</span></code> :</div>
<div class="line">Hz, KHz, MHz, GHz, THz</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">TimeNumber</span></code> and <code class="docutils literal notranslate"><span class="pre">HertzNumber</span></code> are based on the <code class="docutils literal notranslate"><span class="pre">PhysicalNumber</span></code> class which uses scala <code class="docutils literal notranslate"><span class="pre">BigDecimal</span></code> to store numbers.</p>
</div>
</div>

    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="assertion.html" class="btn btn-neutral float-right" title="Assertions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Other language features" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, SpinalHDL

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>